<html>
<head>
<title>rdataset.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #5f826b; font-style: italic;}
.s3 { color: #cf8e6d;}
.s4 { color: #bcbec4;}
.s5 { color: #6aab73;}
.s6 { color: #2aacb8;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
rdataset.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright (C) Dnspython Contributors, see LICENSE for text of ISC license</span>

<span class="s0"># Copyright (C) 2001-2017 Nominum, Inc.</span>
<span class="s0">#</span>
<span class="s0"># Permission to use, copy, modify, and distribute this software and its</span>
<span class="s0"># documentation for any purpose with or without fee is hereby granted,</span>
<span class="s0"># provided that the above copyright notice and this permission notice</span>
<span class="s0"># appear in all copies.</span>
<span class="s0">#</span>
<span class="s0"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND NOMINUM DISCLAIMS ALL WARRANTIES</span>
<span class="s0"># WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="s0"># MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL NOMINUM BE LIABLE FOR</span>
<span class="s0"># ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="s0"># WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="s0"># ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT</span>
<span class="s0"># OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>

<span class="s2">&quot;&quot;&quot;DNS rdatasets (an rdataset is a set of rdatas of a given type and class)&quot;&quot;&quot;</span>

<span class="s3">import </span><span class="s1">io</span>
<span class="s3">import </span><span class="s1">random</span>
<span class="s3">import </span><span class="s1">struct</span>
<span class="s3">from </span><span class="s1">typing </span><span class="s3">import </span><span class="s1">Any</span><span class="s4">, </span><span class="s1">Collection</span><span class="s4">, </span><span class="s1">Dict</span><span class="s4">, </span><span class="s1">List</span><span class="s4">, </span><span class="s1">Optional</span><span class="s4">, </span><span class="s1">Union</span><span class="s4">, </span><span class="s1">cast</span>

<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">exception</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">immutable</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">renderer</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">set</span>
<span class="s3">import </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">ttl</span>

<span class="s0"># define SimpleSet here for backwards compatibility</span>
<span class="s1">SimpleSet </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">set</span><span class="s4">.</span><span class="s1">Set</span>


<span class="s3">class </span><span class="s1">DifferingCovers</span><span class="s4">(</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">exception</span><span class="s4">.</span><span class="s1">DNSException</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;An attempt was made to add a DNS SIG/RRSIG whose covered type 
    is not the same as that of the other rdatas in the rdataset.&quot;&quot;&quot;</span>


<span class="s3">class </span><span class="s1">IncompatibleTypes</span><span class="s4">(</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">exception</span><span class="s4">.</span><span class="s1">DNSException</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;An attempt was made to add DNS RR data of an incompatible type.&quot;&quot;&quot;</span>


<span class="s3">class </span><span class="s1">Rdataset</span><span class="s4">(</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">set</span><span class="s4">.</span><span class="s1">Set</span><span class="s4">):</span>
    <span class="s2">&quot;&quot;&quot;A DNS rdataset.&quot;&quot;&quot;</span>

    <span class="s1">__slots__ </span><span class="s4">= [</span><span class="s5">&quot;rdclass&quot;</span><span class="s4">, </span><span class="s5">&quot;rdtype&quot;</span><span class="s4">, </span><span class="s5">&quot;covers&quot;</span><span class="s4">, </span><span class="s5">&quot;ttl&quot;</span><span class="s4">]</span>

    <span class="s3">def </span><span class="s1">__init__</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">rdclass</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">,</span>
        <span class="s1">rdtype</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">,</span>
        <span class="s1">covers</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">NONE</span><span class="s4">,</span>
        <span class="s1">ttl</span><span class="s4">: </span><span class="s1">int </span><span class="s4">= </span><span class="s6">0</span><span class="s4">,</span>
    <span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Create a new rdataset of the specified class and type. 
 
        *rdclass*, a ``dns.rdataclass.RdataClass``, the rdataclass. 
 
        *rdtype*, an ``dns.rdatatype.RdataType``, the rdatatype. 
 
        *covers*, an ``dns.rdatatype.RdataType``, the covered rdatatype. 
 
        *ttl*, an ``int``, the TTL. 
        &quot;&quot;&quot;</span>

        <span class="s1">super</span><span class="s4">().</span><span class="s1">__init__</span><span class="s4">()</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s4">= </span><span class="s1">rdclass</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType </span><span class="s4">= </span><span class="s1">rdtype</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">covers</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType </span><span class="s4">= </span><span class="s1">covers</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">ttl </span><span class="s4">= </span><span class="s1">ttl</span>

    <span class="s3">def </span><span class="s1">_clone</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s1">obj </span><span class="s4">= </span><span class="s1">super</span><span class="s4">().</span><span class="s1">_clone</span><span class="s4">()</span>
        <span class="s1">obj</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass</span>
        <span class="s1">obj</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span>
        <span class="s1">obj</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers</span>
        <span class="s1">obj</span><span class="s4">.</span><span class="s1">ttl </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">ttl</span>
        <span class="s3">return </span><span class="s1">obj</span>

    <span class="s3">def </span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">ttl</span><span class="s4">: </span><span class="s1">int</span><span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Perform TTL minimization. 
 
        Set the TTL of the rdataset to be the lesser of the set's current 
        TTL or the specified TTL.  If the set contains no rdatas, set the TTL 
        to the specified TTL. 
 
        *ttl*, an ``int`` or ``str``. 
        &quot;&quot;&quot;</span>
        <span class="s1">ttl </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">.</span><span class="s1">make</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) == </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">ttl </span><span class="s4">= </span><span class="s1">ttl</span>
        <span class="s3">elif </span><span class="s1">ttl </span><span class="s4">&lt; </span><span class="s1">self</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">ttl </span><span class="s4">= </span><span class="s1">ttl</span>

    <span class="s3">def </span><span class="s1">add</span><span class="s4">(  </span><span class="s0"># pylint: disable=arguments-differ,arguments-renamed</span>
        <span class="s1">self</span><span class="s4">, </span><span class="s1">rd</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">Rdata</span><span class="s4">, </span><span class="s1">ttl</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">int</span><span class="s4">] = </span><span class="s3">None</span>
    <span class="s4">) </span><span class="s1">-&gt; </span><span class="s3">None</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Add the specified rdata to the rdataset. 
 
        If the optional *ttl* parameter is supplied, then 
        ``self.update_ttl(ttl)`` will be called prior to adding the rdata. 
 
        *rd*, a ``dns.rdata.Rdata``, the rdata 
 
        *ttl*, an ``int``, the TTL. 
 
        Raises ``dns.rdataset.IncompatibleTypes`` if the type and class 
        do not match the type and class of the rdataset. 
 
        Raises ``dns.rdataset.DifferingCovers`` if the type is a signature 
        type and the covered type does not match that of the rdataset. 
        &quot;&quot;&quot;</span>

        <span class="s0">#</span>
        <span class="s0"># If we're adding a signature, do some special handling to</span>
        <span class="s0"># check that the signature covers the same type as the</span>
        <span class="s0"># other rdatas in this rdataset.  If this is the first rdata</span>
        <span class="s0"># in the set, initialize the covers field.</span>
        <span class="s0">#</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s4">!= </span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">!= </span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">:</span>
            <span class="s3">raise </span><span class="s1">IncompatibleTypes</span>
        <span class="s3">if </span><span class="s1">ttl </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">== </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RRSIG </span><span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">== </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">SIG</span><span class="s4">:</span>
            <span class="s1">covers </span><span class="s4">= </span><span class="s1">rd</span><span class="s4">.</span><span class="s1">covers</span><span class="s4">()</span>
            <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) == </span><span class="s6">0 </span><span class="s3">and </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">== </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">NONE</span><span class="s4">:</span>
                <span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">= </span><span class="s1">covers</span>
            <span class="s3">elif </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">!= </span><span class="s1">covers</span><span class="s4">:</span>
                <span class="s3">raise </span><span class="s1">DifferingCovers</span>
        <span class="s3">if </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">is_singleton</span><span class="s4">(</span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">) </span><span class="s3">and </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) &gt; </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">clear</span><span class="s4">()</span>
        <span class="s1">super</span><span class="s4">().</span><span class="s1">add</span><span class="s4">(</span><span class="s1">rd</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">union_update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">other</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s1">super</span><span class="s4">().</span><span class="s1">union_update</span><span class="s4">(</span><span class="s1">other</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">intersection_update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">other</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s1">super</span><span class="s4">().</span><span class="s1">intersection_update</span><span class="s4">(</span><span class="s1">other</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Add all rdatas in other to self. 
 
        *other*, a ``dns.rdataset.Rdataset``, the rdataset from which 
        to update. 
        &quot;&quot;&quot;</span>

        <span class="s1">self</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">other</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s1">super</span><span class="s4">().</span><span class="s1">update</span><span class="s4">(</span><span class="s1">other</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">_rdata_repr</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">def </span><span class="s1">maybe_truncate</span><span class="s4">(</span><span class="s1">s</span><span class="s4">):</span>
            <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">s</span><span class="s4">) &gt; </span><span class="s6">100</span><span class="s4">:</span>
                <span class="s3">return </span><span class="s1">s</span><span class="s4">[:</span><span class="s6">100</span><span class="s4">] + </span><span class="s5">&quot;...&quot;</span>
            <span class="s3">return </span><span class="s1">s</span>

        <span class="s3">return </span><span class="s5">&quot;[&quot; </span><span class="s4">+ </span><span class="s5">&quot;, &quot;</span><span class="s4">.</span><span class="s1">join</span><span class="s4">(</span><span class="s5">f&quot;&lt;</span><span class="s3">{</span><span class="s1">maybe_truncate</span><span class="s4">(</span><span class="s1">str</span><span class="s4">(</span><span class="s1">rr</span><span class="s4">))</span><span class="s3">}</span><span class="s5">&gt;&quot; </span><span class="s3">for </span><span class="s1">rr </span><span class="s3">in </span><span class="s1">self</span><span class="s4">) + </span><span class="s5">&quot;]&quot;</span>

    <span class="s3">def </span><span class="s1">__repr__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">== </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s1">ctext </span><span class="s4">= </span><span class="s5">&quot;&quot;</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">ctext </span><span class="s4">= </span><span class="s5">&quot;(&quot; </span><span class="s4">+ </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers</span><span class="s4">) + </span><span class="s5">&quot;)&quot;</span>
        <span class="s3">return </span><span class="s4">(</span>
            <span class="s5">&quot;&lt;DNS &quot;</span>
            <span class="s4">+ </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass</span><span class="s4">)</span>
            <span class="s4">+ </span><span class="s5">&quot; &quot;</span>
            <span class="s4">+ </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">)</span>
            <span class="s4">+ </span><span class="s1">ctext</span>
            <span class="s4">+ </span><span class="s5">&quot; rdataset: &quot;</span>
            <span class="s4">+ </span><span class="s1">self</span><span class="s4">.</span><span class="s1">_rdata_repr</span><span class="s4">()</span>
            <span class="s4">+ </span><span class="s5">&quot;&gt;&quot;</span>
        <span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__str__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">self</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">()</span>

    <span class="s3">def </span><span class="s1">__eq__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">if not </span><span class="s1">isinstance</span><span class="s4">(</span><span class="s1">other</span><span class="s4">, </span><span class="s1">Rdataset</span><span class="s4">):</span>
            <span class="s3">return False</span>
        <span class="s3">if </span><span class="s4">(</span>
            <span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s4">!= </span><span class="s1">other</span><span class="s4">.</span><span class="s1">rdclass</span>
            <span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">!= </span><span class="s1">other</span><span class="s4">.</span><span class="s1">rdtype</span>
            <span class="s3">or </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">!= </span><span class="s1">other</span><span class="s4">.</span><span class="s1">covers</span>
        <span class="s4">):</span>
            <span class="s3">return False</span>
        <span class="s3">return </span><span class="s1">super</span><span class="s4">().</span><span class="s1">__eq__</span><span class="s4">(</span><span class="s1">other</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__ne__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">return not </span><span class="s1">self</span><span class="s4">.</span><span class="s1">__eq__</span><span class="s4">(</span><span class="s1">other</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">to_text</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">name</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">origin</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">relativize</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">True</span><span class="s4">,</span>
        <span class="s1">override_rdclass</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">want_comments</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">False</span><span class="s4">,</span>
        <span class="s4">**</span><span class="s1">kw</span><span class="s4">: </span><span class="s1">Dict</span><span class="s4">[</span><span class="s1">str</span><span class="s4">, </span><span class="s1">Any</span><span class="s4">],</span>
    <span class="s4">) </span><span class="s1">-&gt; str</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Convert the rdataset into DNS zone file format. 
 
        See ``dns.name.Name.choose_relativity`` for more information 
        on how *origin* and *relativize* determine the way names 
        are emitted. 
 
        Any additional keyword arguments are passed on to the rdata 
        ``to_text()`` method. 
 
        *name*, a ``dns.name.Name``.  If name is not ``None``, emit RRs with 
        *name* as the owner name. 
 
        *origin*, a ``dns.name.Name`` or ``None``, the origin for relative 
        names. 
 
        *relativize*, a ``bool``.  If ``True``, names will be relativized 
        to *origin*. 
 
        *override_rdclass*, a ``dns.rdataclass.RdataClass`` or ``None``. 
        If not ``None``, use this class instead of the Rdataset's class. 
 
        *want_comments*, a ``bool``.  If ``True``, emit comments for rdata 
        which have them.  The default is ``False``. 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">name </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">name </span><span class="s4">= </span><span class="s1">name</span><span class="s4">.</span><span class="s1">choose_relativity</span><span class="s4">(</span><span class="s1">origin</span><span class="s4">, </span><span class="s1">relativize</span><span class="s4">)</span>
            <span class="s1">ntext </span><span class="s4">= </span><span class="s1">str</span><span class="s4">(</span><span class="s1">name</span><span class="s4">)</span>
            <span class="s1">pad </span><span class="s4">= </span><span class="s5">&quot; &quot;</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">ntext </span><span class="s4">= </span><span class="s5">&quot;&quot;</span>
            <span class="s1">pad </span><span class="s4">= </span><span class="s5">&quot;&quot;</span>
        <span class="s1">s </span><span class="s4">= </span><span class="s1">io</span><span class="s4">.</span><span class="s1">StringIO</span><span class="s4">()</span>
        <span class="s3">if </span><span class="s1">override_rdclass </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">rdclass </span><span class="s4">= </span><span class="s1">override_rdclass</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">rdclass </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass</span>
        <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) == </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s0">#</span>
            <span class="s0"># Empty rdatasets are used for the question section, and in</span>
            <span class="s0"># some dynamic updates, so we don't need to print out the TTL</span>
            <span class="s0"># (which is meaningless anyway).</span>
            <span class="s0">#</span>
            <span class="s1">s</span><span class="s4">.</span><span class="s1">write</span><span class="s4">(</span>
                <span class="s5">f&quot;</span><span class="s3">{</span><span class="s1">ntext</span><span class="s3">}{</span><span class="s1">pad</span><span class="s3">}{</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">rdclass</span><span class="s4">)</span><span class="s3">} </span><span class="s5">&quot;</span>
                <span class="s5">f&quot;</span><span class="s3">{</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">)</span><span class="s3">}\n</span><span class="s5">&quot;</span>
            <span class="s4">)</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">for </span><span class="s1">rd </span><span class="s3">in </span><span class="s1">self</span><span class="s4">:</span>
                <span class="s1">extra </span><span class="s4">= </span><span class="s5">&quot;&quot;</span>
                <span class="s3">if </span><span class="s1">want_comments</span><span class="s4">:</span>
                    <span class="s3">if </span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdcomment</span><span class="s4">:</span>
                        <span class="s1">extra </span><span class="s4">= </span><span class="s5">f&quot; ;</span><span class="s3">{</span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdcomment</span><span class="s3">}</span><span class="s5">&quot;</span>
                <span class="s1">s</span><span class="s4">.</span><span class="s1">write</span><span class="s4">(</span>
                    <span class="s5">&quot;%s%s%d %s %s %s%s</span><span class="s3">\n</span><span class="s5">&quot;</span>
                    <span class="s4">% (</span>
                        <span class="s1">ntext</span><span class="s4">,</span>
                        <span class="s1">pad</span><span class="s4">,</span>
                        <span class="s1">self</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">,</span>
                        <span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">rdclass</span><span class="s4">),</span>
                        <span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">),</span>
                        <span class="s1">rd</span><span class="s4">.</span><span class="s1">to_text</span><span class="s4">(</span><span class="s1">origin</span><span class="s4">=</span><span class="s1">origin</span><span class="s4">, </span><span class="s1">relativize</span><span class="s4">=</span><span class="s1">relativize</span><span class="s4">, **</span><span class="s1">kw</span><span class="s4">),</span>
                        <span class="s1">extra</span><span class="s4">,</span>
                    <span class="s4">)</span>
                <span class="s4">)</span>
        <span class="s0">#</span>
        <span class="s0"># We strip off the final \n for the caller's convenience in printing</span>
        <span class="s0">#</span>
        <span class="s3">return </span><span class="s1">s</span><span class="s4">.</span><span class="s1">getvalue</span><span class="s4">()[:-</span><span class="s6">1</span><span class="s4">]</span>

    <span class="s3">def </span><span class="s1">to_wire</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">name</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">,</span>
        <span class="s1">file</span><span class="s4">: </span><span class="s1">Any</span><span class="s4">,</span>
        <span class="s1">compress</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">CompressType</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">origin</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">override_rdclass</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
        <span class="s1">want_shuffle</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">True</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; int</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Convert the rdataset to wire format. 
 
        *name*, a ``dns.name.Name`` is the owner name to use. 
 
        *file* is the file where the name is emitted (typically a 
        BytesIO file). 
 
        *compress*, a ``dict``, is the compression table to use.  If 
        ``None`` (the default), names will not be compressed. 
 
        *origin* is a ``dns.name.Name`` or ``None``.  If the name is 
        relative and origin is not ``None``, then *origin* will be appended 
        to it. 
 
        *override_rdclass*, an ``int``, is used as the class instead of the 
        class of the rdataset.  This is useful when rendering rdatasets 
        associated with dynamic updates. 
 
        *want_shuffle*, a ``bool``.  If ``True``, then the order of the 
        Rdatas within the Rdataset will be shuffled before rendering. 
 
        Returns an ``int``, the number of records emitted. 
        &quot;&quot;&quot;</span>

        <span class="s3">if </span><span class="s1">override_rdclass </span><span class="s3">is not None</span><span class="s4">:</span>
            <span class="s1">rdclass </span><span class="s4">= </span><span class="s1">override_rdclass</span>
            <span class="s1">want_shuffle </span><span class="s4">= </span><span class="s3">False</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">rdclass </span><span class="s4">= </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass</span>
        <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) == </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s1">name</span><span class="s4">.</span><span class="s1">to_wire</span><span class="s4">(</span><span class="s1">file</span><span class="s4">, </span><span class="s1">compress</span><span class="s4">, </span><span class="s1">origin</span><span class="s4">)</span>
            <span class="s1">file</span><span class="s4">.</span><span class="s1">write</span><span class="s4">(</span><span class="s1">struct</span><span class="s4">.</span><span class="s1">pack</span><span class="s4">(</span><span class="s5">&quot;!HHIH&quot;</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">, </span><span class="s1">rdclass</span><span class="s4">, </span><span class="s6">0</span><span class="s4">, </span><span class="s6">0</span><span class="s4">))</span>
            <span class="s3">return </span><span class="s6">1</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s1">l</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">Rdataset</span><span class="s4">, </span><span class="s1">List</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">Rdata</span><span class="s4">]]</span>
            <span class="s3">if </span><span class="s1">want_shuffle</span><span class="s4">:</span>
                <span class="s1">l </span><span class="s4">= </span><span class="s1">list</span><span class="s4">(</span><span class="s1">self</span><span class="s4">)</span>
                <span class="s1">random</span><span class="s4">.</span><span class="s1">shuffle</span><span class="s4">(</span><span class="s1">l</span><span class="s4">)</span>
            <span class="s3">else</span><span class="s4">:</span>
                <span class="s1">l </span><span class="s4">= </span><span class="s1">self</span>
            <span class="s3">for </span><span class="s1">rd </span><span class="s3">in </span><span class="s1">l</span><span class="s4">:</span>
                <span class="s1">name</span><span class="s4">.</span><span class="s1">to_wire</span><span class="s4">(</span><span class="s1">file</span><span class="s4">, </span><span class="s1">compress</span><span class="s4">, </span><span class="s1">origin</span><span class="s4">)</span>
                <span class="s1">file</span><span class="s4">.</span><span class="s1">write</span><span class="s4">(</span><span class="s1">struct</span><span class="s4">.</span><span class="s1">pack</span><span class="s4">(</span><span class="s5">&quot;!HHI&quot;</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">, </span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">self</span><span class="s4">.</span><span class="s1">ttl</span><span class="s4">))</span>
                <span class="s3">with </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">renderer</span><span class="s4">.</span><span class="s1">prefixed_length</span><span class="s4">(</span><span class="s1">file</span><span class="s4">, </span><span class="s6">2</span><span class="s4">):</span>
                    <span class="s1">rd</span><span class="s4">.</span><span class="s1">to_wire</span><span class="s4">(</span><span class="s1">file</span><span class="s4">, </span><span class="s1">compress</span><span class="s4">, </span><span class="s1">origin</span><span class="s4">)</span>
            <span class="s3">return </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">match</span><span class="s4">(</span>
        <span class="s1">self</span><span class="s4">,</span>
        <span class="s1">rdclass</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">,</span>
        <span class="s1">rdtype</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">,</span>
        <span class="s1">covers</span><span class="s4">: </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">,</span>
    <span class="s4">) </span><span class="s1">-&gt; bool</span><span class="s4">:</span>
        <span class="s2">&quot;&quot;&quot;Returns ``True`` if this rdataset matches the specified class, 
        type, and covers. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdclass </span><span class="s4">== </span><span class="s1">rdclass </span><span class="s3">and </span><span class="s1">self</span><span class="s4">.</span><span class="s1">rdtype </span><span class="s4">== </span><span class="s1">rdtype </span><span class="s3">and </span><span class="s1">self</span><span class="s4">.</span><span class="s1">covers </span><span class="s4">== </span><span class="s1">covers</span><span class="s4">:</span>
            <span class="s3">return True</span>
        <span class="s3">return False</span>

    <span class="s3">def </span><span class="s1">processing_order</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) </span><span class="s1">-&gt; List</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">Rdata</span><span class="s4">]:</span>
        <span class="s2">&quot;&quot;&quot;Return rdatas in a valid processing order according to the type's 
        specification.  For example, MX records are in preference order from 
        lowest to highest preferences, with items of the same preference 
        shuffled. 
 
        For types that do not define a processing order, the rdatas are 
        simply shuffled. 
        &quot;&quot;&quot;</span>
        <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">self</span><span class="s4">) == </span><span class="s6">0</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s4">[]</span>
        <span class="s3">else</span><span class="s4">:</span>
            <span class="s3">return </span><span class="s1">self</span><span class="s4">[</span><span class="s6">0</span><span class="s4">].</span><span class="s1">_processing_order</span><span class="s4">(</span><span class="s1">iter</span><span class="s4">(</span><span class="s1">self</span><span class="s4">))</span>


<span class="s4">@</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">immutable</span><span class="s4">.</span><span class="s1">immutable</span>
<span class="s3">class </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">Rdataset</span><span class="s4">):  </span><span class="s0"># lgtm[py/missing-equals]</span>
    <span class="s2">&quot;&quot;&quot;An immutable DNS rdataset.&quot;&quot;&quot;</span>

    <span class="s1">_clone_class </span><span class="s4">= </span><span class="s1">Rdataset</span>

    <span class="s3">def </span><span class="s1">__init__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">rdataset</span><span class="s4">: </span><span class="s1">Rdataset</span><span class="s4">):</span>
        <span class="s2">&quot;&quot;&quot;Create an immutable rdataset from the specified rdataset.&quot;&quot;&quot;</span>

        <span class="s1">super</span><span class="s4">().</span><span class="s1">__init__</span><span class="s4">(</span>
            <span class="s1">rdataset</span><span class="s4">.</span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">rdataset</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">, </span><span class="s1">rdataset</span><span class="s4">.</span><span class="s1">covers</span><span class="s4">, </span><span class="s1">rdataset</span><span class="s4">.</span><span class="s1">ttl</span>
        <span class="s4">)</span>
        <span class="s1">self</span><span class="s4">.</span><span class="s1">items </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">immutable</span><span class="s4">.</span><span class="s1">Dict</span><span class="s4">(</span><span class="s1">rdataset</span><span class="s4">.</span><span class="s1">items</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">ttl</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">add</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">rd</span><span class="s4">, </span><span class="s1">ttl</span><span class="s4">=</span><span class="s3">None</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">union_update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">intersection_update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">update</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__delitem__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">i</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s0"># lgtm complains about these not raising ArithmeticError, but there is</span>
    <span class="s0"># precedent for overrides of these methods in other classes to raise</span>
    <span class="s0"># TypeError, and it seems like the better exception.</span>

    <span class="s3">def </span><span class="s1">__ior__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):  </span><span class="s0"># lgtm[py/unexpected-raise-in-special-method]</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__iand__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):  </span><span class="s0"># lgtm[py/unexpected-raise-in-special-method]</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__iadd__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):  </span><span class="s0"># lgtm[py/unexpected-raise-in-special-method]</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__isub__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):  </span><span class="s0"># lgtm[py/unexpected-raise-in-special-method]</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">clear</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">raise </span><span class="s1">TypeError</span><span class="s4">(</span><span class="s5">&quot;immutable&quot;</span><span class="s4">)</span>

    <span class="s3">def </span><span class="s1">__copy__</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">copy</span><span class="s4">())</span>

    <span class="s3">def </span><span class="s1">copy</span><span class="s4">(</span><span class="s1">self</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">copy</span><span class="s4">())</span>

    <span class="s3">def </span><span class="s1">union</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">union</span><span class="s4">(</span><span class="s1">other</span><span class="s4">))</span>

    <span class="s3">def </span><span class="s1">intersection</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">intersection</span><span class="s4">(</span><span class="s1">other</span><span class="s4">))</span>

    <span class="s3">def </span><span class="s1">difference</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">difference</span><span class="s4">(</span><span class="s1">other</span><span class="s4">))</span>

    <span class="s3">def </span><span class="s1">symmetric_difference</span><span class="s4">(</span><span class="s1">self</span><span class="s4">, </span><span class="s1">other</span><span class="s4">):</span>
        <span class="s3">return </span><span class="s1">ImmutableRdataset</span><span class="s4">(</span><span class="s1">super</span><span class="s4">().</span><span class="s1">symmetric_difference</span><span class="s4">(</span><span class="s1">other</span><span class="s4">))</span>


<span class="s3">def </span><span class="s1">from_text_list</span><span class="s4">(</span>
    <span class="s1">rdclass</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">, </span><span class="s1">str</span><span class="s4">],</span>
    <span class="s1">rdtype</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">, </span><span class="s1">str</span><span class="s4">],</span>
    <span class="s1">ttl</span><span class="s4">: </span><span class="s1">int</span><span class="s4">,</span>
    <span class="s1">text_rdatas</span><span class="s4">: </span><span class="s1">Collection</span><span class="s4">[</span><span class="s1">str</span><span class="s4">],</span>
    <span class="s1">idna_codec</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">IDNACodec</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s1">origin</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
    <span class="s1">relativize</span><span class="s4">: </span><span class="s1">bool </span><span class="s4">= </span><span class="s3">True</span><span class="s4">,</span>
    <span class="s1">relativize_to</span><span class="s4">: </span><span class="s1">Optional</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">name</span><span class="s4">.</span><span class="s1">Name</span><span class="s4">] = </span><span class="s3">None</span><span class="s4">,</span>
<span class="s4">) </span><span class="s1">-&gt; Rdataset</span><span class="s4">:</span>
    <span class="s2">&quot;&quot;&quot;Create an rdataset with the specified class, type, and TTL, and with 
    the specified list of rdatas in text format. 
 
    *idna_codec*, a ``dns.name.IDNACodec``, specifies the IDNA 
    encoder/decoder to use; if ``None``, the default IDNA 2003 
    encoder/decoder is used. 
 
    *origin*, a ``dns.name.Name`` (or ``None``), the 
    origin to use for relative names. 
 
    *relativize*, a ``bool``.  If true, name will be relativized. 
 
    *relativize_to*, a ``dns.name.Name`` (or ``None``), the origin to use 
    when relativizing names.  If not set, the *origin* value will be used. 
 
    Returns a ``dns.rdataset.Rdataset`` object. 
    &quot;&quot;&quot;</span>

    <span class="s1">rdclass </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">.</span><span class="s1">make</span><span class="s4">(</span><span class="s1">rdclass</span><span class="s4">)</span>
    <span class="s1">rdtype </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">.</span><span class="s1">make</span><span class="s4">(</span><span class="s1">rdtype</span><span class="s4">)</span>
    <span class="s1">r </span><span class="s4">= </span><span class="s1">Rdataset</span><span class="s4">(</span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">rdtype</span><span class="s4">)</span>
    <span class="s1">r</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">)</span>
    <span class="s3">for </span><span class="s1">t </span><span class="s3">in </span><span class="s1">text_rdatas</span><span class="s4">:</span>
        <span class="s1">rd </span><span class="s4">= </span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">from_text</span><span class="s4">(</span>
            <span class="s1">r</span><span class="s4">.</span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">r</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">, </span><span class="s1">t</span><span class="s4">, </span><span class="s1">origin</span><span class="s4">, </span><span class="s1">relativize</span><span class="s4">, </span><span class="s1">relativize_to</span><span class="s4">, </span><span class="s1">idna_codec</span>
        <span class="s4">)</span>
        <span class="s1">r</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">rd</span><span class="s4">)</span>
    <span class="s3">return </span><span class="s1">r</span>


<span class="s3">def </span><span class="s1">from_text</span><span class="s4">(</span>
    <span class="s1">rdclass</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdataclass</span><span class="s4">.</span><span class="s1">RdataClass</span><span class="s4">, </span><span class="s1">str</span><span class="s4">],</span>
    <span class="s1">rdtype</span><span class="s4">: </span><span class="s1">Union</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdatatype</span><span class="s4">.</span><span class="s1">RdataType</span><span class="s4">, </span><span class="s1">str</span><span class="s4">],</span>
    <span class="s1">ttl</span><span class="s4">: </span><span class="s1">int</span><span class="s4">,</span>
    <span class="s4">*</span><span class="s1">text_rdatas</span><span class="s4">: </span><span class="s1">Any</span><span class="s4">,</span>
<span class="s4">) </span><span class="s1">-&gt; Rdataset</span><span class="s4">:</span>
    <span class="s2">&quot;&quot;&quot;Create an rdataset with the specified class, type, and TTL, and with 
    the specified rdatas in text format. 
 
    Returns a ``dns.rdataset.Rdataset`` object. 
    &quot;&quot;&quot;</span>

    <span class="s3">return </span><span class="s1">from_text_list</span><span class="s4">(</span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">rdtype</span><span class="s4">, </span><span class="s1">ttl</span><span class="s4">, </span><span class="s1">cast</span><span class="s4">(</span><span class="s1">Collection</span><span class="s4">[</span><span class="s1">str</span><span class="s4">], </span><span class="s1">text_rdatas</span><span class="s4">))</span>


<span class="s3">def </span><span class="s1">from_rdata_list</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">: </span><span class="s1">int</span><span class="s4">, </span><span class="s1">rdatas</span><span class="s4">: </span><span class="s1">Collection</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">Rdata</span><span class="s4">]) </span><span class="s1">-&gt; Rdataset</span><span class="s4">:</span>
    <span class="s2">&quot;&quot;&quot;Create an rdataset with the specified TTL, and with 
    the specified list of rdata objects. 
 
    Returns a ``dns.rdataset.Rdataset`` object. 
    &quot;&quot;&quot;</span>

    <span class="s3">if </span><span class="s1">len</span><span class="s4">(</span><span class="s1">rdatas</span><span class="s4">) == </span><span class="s6">0</span><span class="s4">:</span>
        <span class="s3">raise </span><span class="s1">ValueError</span><span class="s4">(</span><span class="s5">&quot;rdata list must not be empty&quot;</span><span class="s4">)</span>
    <span class="s1">r </span><span class="s4">= </span><span class="s3">None</span>
    <span class="s3">for </span><span class="s1">rd </span><span class="s3">in </span><span class="s1">rdatas</span><span class="s4">:</span>
        <span class="s3">if </span><span class="s1">r </span><span class="s3">is None</span><span class="s4">:</span>
            <span class="s1">r </span><span class="s4">= </span><span class="s1">Rdataset</span><span class="s4">(</span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdclass</span><span class="s4">, </span><span class="s1">rd</span><span class="s4">.</span><span class="s1">rdtype</span><span class="s4">)</span>
            <span class="s1">r</span><span class="s4">.</span><span class="s1">update_ttl</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">)</span>
        <span class="s1">r</span><span class="s4">.</span><span class="s1">add</span><span class="s4">(</span><span class="s1">rd</span><span class="s4">)</span>
    <span class="s3">assert </span><span class="s1">r </span><span class="s3">is not None</span>
    <span class="s3">return </span><span class="s1">r</span>


<span class="s3">def </span><span class="s1">from_rdata</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">: </span><span class="s1">int</span><span class="s4">, *</span><span class="s1">rdatas</span><span class="s4">: </span><span class="s1">Any</span><span class="s4">) </span><span class="s1">-&gt; Rdataset</span><span class="s4">:</span>
    <span class="s2">&quot;&quot;&quot;Create an rdataset with the specified TTL, and with 
    the specified rdata objects. 
 
    Returns a ``dns.rdataset.Rdataset`` object. 
    &quot;&quot;&quot;</span>

    <span class="s3">return </span><span class="s1">from_rdata_list</span><span class="s4">(</span><span class="s1">ttl</span><span class="s4">, </span><span class="s1">cast</span><span class="s4">(</span><span class="s1">Collection</span><span class="s4">[</span><span class="s1">dns</span><span class="s4">.</span><span class="s1">rdata</span><span class="s4">.</span><span class="s1">Rdata</span><span class="s4">], </span><span class="s1">rdatas</span><span class="s4">))</span>
</pre>
</body>
</html>